import{d as e,m as t,a,o as s,c as l,w as i,b as r,t as n,n as o,e as u,f as d,i as c,r as p,g as b,h,j as g,F as _,k as m,l as f,S as y,p as v,q as w,s as S,u as x,v as C,x as k,y as $,z as B,A as N}from"./index-c10f9bc5.js";import{_ as T}from"./uni-icons.86887c9d.js";import{r as j,o as R}from"./uni-app.es.7b888dc1.js";import{_ as z}from"./_plugin-vue_export-helper.1b428a4d.js";import{_ as L}from"./logo.91813b25.js";import{g as D}from"./data.700934dc.js";import{_ as W}from"./u-loading-icon.404c4b0c.js";import{C as A}from"./card-list1.370a1e10.js";import"./member.156f20f2.js";import"./u-image.0192172e.js";const I=z({name:"u-badge",mixins:[t,{props:{isDot:{type:Boolean,default:e.badge.isDot},value:{type:[Number,String],default:e.badge.value},modelValue:{type:[Number,String],default:e.badge.modelValue},show:{type:Boolean,default:e.badge.show},max:{type:[Number,String],default:e.badge.max},type:{type:String,default:e.badge.type},showZero:{type:Boolean,default:e.badge.showZero},bgColor:{type:[String,null],default:e.badge.bgColor},color:{type:[String,null],default:e.badge.color},shape:{type:String,default:e.badge.shape},numberType:{type:String,default:e.badge.numberType},offset:{type:Array,default:e.badge.offset},inverted:{type:Boolean,default:e.badge.inverted},absolute:{type:Boolean,default:e.badge.absolute}}},a],computed:{boxStyle:()=>({}),badgeStyle(){const e={};if(this.color&&(e.color=this.color),this.bgColor&&!this.inverted&&(e.backgroundColor=this.bgColor),this.absolute&&(e.position="absolute",this.offset.length)){const t=this.offset[0],a=this.offset[1]||t;e.top=uni.$u.addUnit(t),e.right=uni.$u.addUnit(a)}return e},showValue(){switch(this.numberType){case"overflow":return Number(this.value)>Number(this.max)?this.max+"+":this.value;case"ellipsis":return Number(this.value)>Number(this.max)?"...":this.value;case"limit":return Number(this.value)>999?Number(this.value)>=9999?Math.floor(this.value/1e4*100)/100+"w":Math.floor(this.value/1e3*100)/100+"k":this.value;default:return Number(this.value)}}}},[["render",function(e,t,a,p,b,h){const g=c;return e.show&&(0!==Number(e.value)||e.showZero||e.isDot)?(s(),l(g,{key:0,class:o([[e.isDot?"u-badge--dot":"u-badge--not-dot",e.inverted&&"u-badge--inverted","horn"===e.shape&&"u-badge--horn",`u-badge--${e.type}${e.inverted?"--inverted":""}`],"u-badge"]),style:u([e.$u.addStyle(e.customStyle),h.badgeStyle])},{default:i((()=>[r(n(e.isDot?"":h.showValue),1)])),_:1},8,["class","style"])):d("",!0)}],["__scopeId","data-v-ca2c7ba1"]]);const P=z({name:"u-tabs",mixins:[t,a,{props:{duration:{type:Number,default:e.tabs.duration},list:{type:Array,default:e.tabs.list},lineColor:{type:String,default:e.tabs.lineColor},activeStyle:{type:[String,Object],default:e.tabs.activeStyle},inactiveStyle:{type:[String,Object],default:e.tabs.inactiveStyle},lineWidth:{type:[String,Number],default:e.tabs.lineWidth},lineHeight:{type:[String,Number],default:e.tabs.lineHeight},lineBgSize:{type:String,default:e.tabs.lineBgSize},itemStyle:{type:[String,Object],default:e.tabs.itemStyle},scrollable:{type:Boolean,default:e.tabs.scrollable},current:{type:[Number,String],default:e.tabs.current},keyName:{type:String,default:e.tabs.keyName}}}],data:()=>({firstTime:!0,scrollLeft:0,scrollViewWidth:0,lineOffsetLeft:0,tabsRect:{left:0},innerCurrent:0,moving:!1}),watch:{current:{immediate:!0,handler(e,t){e!==this.innerCurrent&&(this.innerCurrent=e,this.$nextTick((()=>{this.resize()})))}},list(){this.$nextTick((()=>{this.resize()}))}},computed:{textStyle(){return e=>{const t={},a=e===this.innerCurrent?uni.$u.addStyle(this.activeStyle):uni.$u.addStyle(this.inactiveStyle);return this.list[e].disabled&&(t.color="#c8c9cc"),uni.$u.deepMerge(a,t)}},propsBadge:()=>uni.$u.props.badge},async mounted(){this.init()},emits:["click","change"],methods:{setLineLeft(){const e=this.list[this.innerCurrent];if(!e)return;let t=this.list.slice(0,this.innerCurrent).reduce(((e,t)=>e+t.rect.width),0);const a=uni.$u.getPx(this.lineWidth);this.lineOffsetLeft=t+(e.rect.width-a)/2,this.firstTime&&setTimeout((()=>{this.firstTime=!1}),10)},animation(e,t=0){},clickHandler(e,t){this.$emit("click",{...e,index:t}),e.disabled||(this.innerCurrent=t,this.resize(),this.$emit("change",{...e,index:t}))},init(){uni.$u.sleep().then((()=>{this.resize()}))},setScrollLeft(){const e=this.list[this.innerCurrent],t=this.list.slice(0,this.innerCurrent).reduce(((e,t)=>e+t.rect.width),0),a=uni.$u.sys().windowWidth;let s=t-(this.tabsRect.width-e.rect.width)/2-(a-this.tabsRect.right)/2+this.tabsRect.left/2;s=Math.min(s,this.scrollViewWidth-this.tabsRect.width),this.scrollLeft=Math.max(0,s)},resize(){0!==this.list.length&&Promise.all([this.getTabsRect(),this.getAllItemRect()]).then((([e,t=[]])=>{this.tabsRect=e,this.scrollViewWidth=0,t.map(((e,t)=>{this.scrollViewWidth+=e.width,this.list[t].rect=e})),this.setLineLeft(),this.setScrollLeft()}))},getTabsRect(){return new Promise((e=>{this.queryRect("u-tabs__wrapper__scroll-view").then((t=>e(t)))}))},getAllItemRect(){return new Promise((e=>{const t=this.list.map(((e,t)=>this.queryRect(`u-tabs__wrapper__nav__item-${t}`,!0)));Promise.all(t).then((t=>e(t)))}))},queryRect(e,t){return new Promise((t=>{this.$uGetRect(`.${e}`).then((e=>{t(e)}))}))}}},[["render",function(e,t,a,d,v,w){const S=c,x=j(p("u-badge"),I),C=f,k=y;return s(),l(C,{class:"u-tabs"},{default:i((()=>[b(C,{class:"u-tabs__wrapper"},{default:i((()=>[h(e.$slots,"left",{},void 0,!0),b(C,{class:"u-tabs__wrapper__scroll-view-wrapper"},{default:i((()=>[b(k,{"scroll-x":e.scrollable,"scroll-left":v.scrollLeft,"scroll-with-animation":"",class:"u-tabs__wrapper__scroll-view","show-scrollbar":!1,ref:"u-tabs__wrapper__scroll-view"},{default:i((()=>[b(C,{class:"u-tabs__wrapper__nav",ref:"u-tabs__wrapper__nav"},{default:i((()=>[(s(!0),g(_,null,m(e.list,((t,a)=>(s(),l(C,{class:o(["u-tabs__wrapper__nav__item",[`u-tabs__wrapper__nav__item-${a}`,t.disabled&&"u-tabs__wrapper__nav__item--disabled"]]),key:a,onClick:e=>w.clickHandler(t,a),ref_for:!0,ref:`u-tabs__wrapper__nav__item-${a}`,style:u([e.$u.addStyle(e.itemStyle),{flex:e.scrollable?"":1}])},{default:i((()=>[b(S,{class:o([[t.disabled&&"u-tabs__wrapper__nav__item__text--disabled"],"u-tabs__wrapper__nav__item__text"]),style:u([w.textStyle(a)])},{default:i((()=>[r(n(t[e.keyName]),1)])),_:2},1032,["class","style"]),b(x,{show:!(!t.badge||!(t.badge.show||t.badge.isDot||t.badge.value)),isDot:t.badge&&t.badge.isDot||w.propsBadge.isDot,value:t.badge&&t.badge.value||w.propsBadge.value,max:t.badge&&t.badge.max||w.propsBadge.max,type:t.badge&&t.badge.type||w.propsBadge.type,showZero:t.badge&&t.badge.showZero||w.propsBadge.showZero,bgColor:t.badge&&t.badge.bgColor||w.propsBadge.bgColor,color:t.badge&&t.badge.color||w.propsBadge.color,shape:t.badge&&t.badge.shape||w.propsBadge.shape,numberType:t.badge&&t.badge.numberType||w.propsBadge.numberType,inverted:t.badge&&t.badge.inverted||w.propsBadge.inverted,customStyle:"margin-left: 4px;"},null,8,["show","isDot","value","max","type","showZero","bgColor","color","shape","numberType","inverted"])])),_:2},1032,["onClick","style","class"])))),128)),b(C,{class:"u-tabs__wrapper__nav__line",ref:"u-tabs__wrapper__nav__line",style:u([{width:e.$u.addUnit(e.lineWidth),transform:`translate(${v.lineOffsetLeft}px)`,transitionDuration:`${v.firstTime?0:e.duration}ms`,height:e.$u.addUnit(e.lineHeight),background:e.lineColor,backgroundSize:e.lineBgSize}])},null,8,["style"])])),_:1},512)])),_:1},8,["scroll-x","scroll-left"])])),_:1}),h(e.$slots,"right",{},void 0,!0)])),_:3})])),_:3})}],["__scopeId","data-v-5c753c99"]]),V=z({__name:"tabs-item",props:{list:Array,banners:Array,tabsCurrent:Number},setup(e){const t=e,a=v({list:[],banners:[]}),u=v(!1);w((()=>[t.tabsCurrent]),(([e])=>{u.value=!1})),w((()=>[t.list,t.banners]),(([e,t])=>{a.value.list=e,a.value.banners=t,u.value=!0}));const h=v(0),y=e=>{h.value=e.detail.current};return(t,v)=>{const w=x,$=f,B=C,N=k,T=c,R=j(p("u-loading-icon"),W);return u.value?(s(),l($,{key:0,class:"tabs-item"},{default:i((()=>[e.list?(s(),l($,{key:0,class:"banners",style:{position:"relative","padding-top":"20rpx"}},{default:i((()=>[b(N,{style:{height:"350rpx"},circular:!0,autoplay:!1,interval:3e3,duration:1e3,onChange:y},{default:i((()=>[(s(!0),g(_,null,m(a.value.banners,((e,t)=>(s(),l(B,null,{default:i((()=>[b(w,{style:{width:"100%",height:"100%","border-radius":"20rpx"},src:e.img,onClick:t=>{return a=e.movieId,void S({url:"/pages/playPage/playPage?id="+a});var a}},null,8,["src","onClick"]),b($,{class:"nm"},{default:i((()=>[r(n(e.nm),1)])),_:2},1024)])),_:2},1024)))),256))])),_:1}),b($,{class:"indicator"},{default:i((()=>[(s(!0),g(_,null,m(a.value.banners.length,((e,t)=>(s(),l(T,{key:e,class:o(["dot",{active:t===h.value}])},null,8,["class"])))),128))])),_:1})])),_:1})):d("",!0),(s(!0),g(_,null,m(a.value.list,(e=>(s(),l($,{class:""},{default:i((()=>[b($,{style:{"font-size":"34rpx","font-weight":"700",margin:"30rpx 0"}},{default:i((()=>[r(n(e.title),1)])),_:2},1024),b(A,{list:e.movieList},null,8,["list"])])),_:2},1024)))),256))])),_:1})):(s(),l(R,{key:1,color:"#9bd9bb",size:"36"}))}}},[["__scopeId","data-v-8d724861"]]),Z=z({__name:"index",setup(e){const{safeAreaInsets:t}=$(),a=[{name:"推荐"},{name:"电影"},{name:"连续剧"},{name:"综艺"},{name:"动漫"}],l=v([]);R((async()=>{await n()}));const n=async()=>{const e=await D(a[m.value].name);l.value=e},o=()=>{S({url:"/pages/history/history"})},d=()=>{S({url:"/pages/search/search"})},h=e=>{m.value=e.index,n(),N({duration:0,scrollTop:0})},m=v(0);return v(!0),v(!1),(e,n)=>{var v;const w=x,S=f,C=j(p("uni-icons"),T),k=c,$=j(p("u-tabs"),P),N=y;return s(),g(_,null,[b(S,{class:"navbar",style:u({paddingTop:(null==(v=B(t))?void 0:v.top)+"px"})},{default:i((()=>[b(S,{class:"head"},{default:i((()=>[b(S,{class:"left"},{default:i((()=>[b(w,{src:L})])),_:1}),b(S,{class:"center",onClick:d},{default:i((()=>[b(S,{class:"search"},{default:i((()=>[b(C,{type:"search",size:"22",color:"#0F2E58"}),b(k,{class:"icon-search"},{default:i((()=>[r("搜片名")])),_:1})])),_:1})])),_:1}),b(S,{class:"right"},{default:i((()=>[b(S,{class:"history",onClick:o},{default:i((()=>[b(w,{src:"/assets/clock-884768e7.png",style:{width:"88rpx",height:"88rpx"}})])),_:1})])),_:1})])),_:1}),b(S,{class:"content"},{default:i((()=>[b($,{list:a,lineColor:"#0F2E58",lineWidth:"30",onChange:h,current:m.value,activeStyle:{color:"#0F2E58",fontWeight:"bold",transform:"scale(1.05)"},inactiveStyle:{color:"#000",transform:"scale(1)"}},null,8,["current","activeStyle","inactiveStyle"])])),_:1})])),_:1},8,["style"]),b(N,{"scroll-y":"",class:"scroll-view"},{default:i((()=>[b(V,{list:l.value.list,banners:l.value.banners,tabsCurrent:m.value},null,8,["list","banners","tabsCurrent"])])),_:1})],64)}}},[["__scopeId","data-v-1737d7d0"]]);export{Z as default};
